{"name":"DF_TRNSF_Oro","ppdf:dataflowId":"5b4a052d-9850-4044-9b27-25d75e27c100","ppdf:owner":{"tenantId":"e6816e25-41db-4bb7-b1a6-25a718776f8c","userId":"13124086-34d6-4604-975f-7ab57860ca21"},"ppdf:fastCopy":true,"version":"1.0","culture":"es-ES","modifiedTime":"2025-05-22T15:06:01.9603195+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"Productos":{"queryId":"79d4c545-226d-4c9b-8d5d-38122c215f0f","queryName":"Productos"},"Órdenes":{"queryId":"5999c5e5-c50d-4146-aa40-11b655177bbc","queryName":"Órdenes"},"Territorios":{"queryId":"fc84088b-37fc-4c40-a8eb-2f1278f0a48c","queryName":"Territorios"},"Fecha_Inicio":{"queryId":"3a9a7f02-54a1-42ec-bea7-0cad2cb033bb","queryName":"Fecha_Inicio"},"fn_Calendario":{"queryId":"565fe7cb-53a4-483c-8953-9ae76b06c0c4","queryName":"fn_Calendario"},"Calendario":{"queryId":"ea6c2451-435d-409d-b13c-d1fbfd150b18","queryName":"Calendario"},"Productos_DataDestination":{"queryId":"4430e1b5-68c2-4d0c-a94c-5a84b30c0ee9","queryName":"Productos_DataDestination"},"Territorios_DataDestination":{"queryId":"705b48e4-d2d8-4506-9e37-a38ad4e36612","queryName":"Territorios_DataDestination"},"Órdenes_DataDestination":{"queryId":"862cf9d1-7d24-47b5-982d-05c98344e1d2","queryName":"Órdenes_DataDestination"},"Calendario_DataDestination":{"queryId":"1ba08dc9-e2bb-49ac-a6bd-eb89f3e7a85f","queryName":"Calendario_DataDestination"},"Productos_WriteToDataDestination":{"queryId":"f97e7b09-02c6-4777-9491-6b716d290240","queryName":"Productos_WriteToDataDestination"},"Productos_TransformForWriteToDataDestination":{"queryId":"3507ff3a-9a86-4798-af98-2605a7caa9e7","queryName":"Productos_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"97ce09a3-2cf5-4115-a4a2-ea0a758bdcc1","queryName":"FastCopyStaging"},"Órdenes_WriteToDataDestination":{"queryId":"ce2c9318-09f1-4cb2-9381-4e80157fceef","queryName":"Órdenes_WriteToDataDestination"},"Órdenes_TransformForWriteToDataDestination":{"queryId":"4dfe46c3-6cb1-43e1-90bc-d7ac054c9b0c","queryName":"Órdenes_TransformForWriteToDataDestination"},"Territorios_WriteToDataDestination":{"queryId":"21094b8e-e410-4943-be23-38c232db1438","queryName":"Territorios_WriteToDataDestination"},"Territorios_TransformForWriteToDataDestination":{"queryId":"2fc81fc1-14bd-4c6b-844a-b2a175c4e2e4","queryName":"Territorios_TransformForWriteToDataDestination"},"Calendario_WriteToDataDestination":{"queryId":"3be320dc-479c-48bb-9ef2-cda223770b11","queryName":"Calendario_WriteToDataDestination"},"Calendario_TransformForWriteToDataDestination":{"queryId":"772aa30c-3d1b-4279-813d-1f781108c80a","queryName":"Calendario_TransformForWriteToDataDestination"}},"document":"section Section1;\r\nshared Productos = let\r\n  Origen = Lakehouse.Contents(null),\r\n  Navegación = Origen{[workspaceId = \"e234b20b-49a1-4e27-85b8-03fa86367e92\"]}[Data],\r\n  #\"Navegación 1\" = Navegación{[lakehouseId = \"ab0b5b6a-2f74-40f0-a556-8667e3ef3fe4\"]}[Data],\r\n  #\"Navegación 2\" = #\"Navegación 1\"{[Id = \"Production_Product\", ItemKind = \"Table\"]}[Data],\r\n  #\"Elegir columnas\" = Table.SelectColumns(#\"Navegación 2\", {\"ProductID\", \"Name\", \"Color\", \"ListPrice\", \"Subcategory\", \"Category\"}),\r\n  #\"Tipo de columna cambiado\" = Table.TransformColumnTypes(#\"Elegir columnas\", {{\"ProductID\", Int64.Type}}),\r\n  #\"Tipo de columna cambiado con configuración regional\" = Table.TransformColumnTypes(#\"Tipo de columna cambiado\", {{\"ListPrice\", type number}}, \"en-US\")\r\nin\r\n  #\"Tipo de columna cambiado con configuración regional\";\r\nshared Órdenes = let\r\n  Origen = Lakehouse.Contents(null),\r\n  Navegación = Origen{[workspaceId = \"e234b20b-49a1-4e27-85b8-03fa86367e92\"]}[Data],\r\n  #\"Navegación 1\" = Navegación{[lakehouseId = \"ab0b5b6a-2f74-40f0-a556-8667e3ef3fe4\"]}[Data],\r\n  #\"Navegación 2\" = #\"Navegación 1\"{[Id = \"Sales_SalesOrderDetail\", ItemKind = \"Table\"]}[Data],\r\n  #\"Columnas quitadas\" = Table.RemoveColumns(#\"Navegación 2\", {\"ModifiedDate\"}),\r\n  #\"Texto antes del delimitador extraído\" = Table.TransformColumns(#\"Columnas quitadas\", {{\"OrderDate\", each Text.BeforeDelimiter(_, \" \", 0), type text}, {\"DueDate\", each Text.BeforeDelimiter(_, \" \", 0), type text}, {\"ShipDate\", each Text.BeforeDelimiter(_, \" \", 0), type text}}),\r\n  #\"Tipo de columna cambiado con configuración regional\" = Table.TransformColumnTypes(#\"Texto antes del delimitador extraído\", {{\"UnitPrice\", type number}, {\"UnitPriceDiscount\", type number}, {\"OrderDate\", type date}, {\"DueDate\", type date}, {\"ShipDate\", type date}, {\"SalesOrderID\", Int64.Type}, {\"OrderQty\", Int64.Type}, {\"ProductID\", Int64.Type}, {\"TerritoryID\", Int64.Type}}, \"en-US\")\r\nin\r\n  #\"Tipo de columna cambiado con configuración regional\";\r\nshared Territorios = let\r\n  Origen = Lakehouse.Contents(null),\r\n  Navegación = Origen{[workspaceId = \"e234b20b-49a1-4e27-85b8-03fa86367e92\"]}[Data],\r\n  #\"Navegación 1\" = Navegación{[lakehouseId = \"ab0b5b6a-2f74-40f0-a556-8667e3ef3fe4\"]}[Data],\r\n  #\"Navegación 2\" = #\"Navegación 1\"{[Id = \"Sales_SalesTerritory\", ItemKind = \"Table\"]}[Data],\r\n  #\"Elegir columnas\" = Table.SelectColumns(#\"Navegación 2\", {\"TerritoryID\", \"Name\", \"Group\"}),\r\n  #\"Columnas con nombre cambiado\" = Table.RenameColumns(#\"Elegir columnas\", {{\"Name\", \"Región\"}, {\"Group\", \"Grupo\"}}),\r\n  #\"Tipo de columna cambiado\" = Table.TransformColumnTypes(#\"Columnas con nombre cambiado\", {{\"TerritoryID\", Int64.Type}})\r\nin\r\n  #\"Tipo de columna cambiado\";\r\nshared Fecha_Inicio = let\r\n  Fecha_Inicio = #date(2011, 1, 1) meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = type date]\r\nin\r\n  Fecha_Inicio;\r\nshared fn_Calendario = let\r\n  fn_Calendario = (dias as number)=>\nlet\n    Origen = List.Dates(#\"Fecha_Inicio\", dias, #duration(1,0,0,0))\nin\n    Origen\r\nin\r\n  fn_Calendario;\r\nshared Calendario = let\n  Origen = fn_Calendario(1826),\n  #\"Convertido en tabla\" = Table.FromList(Origen, Splitter.SplitByNothing(), null, null, ExtraValues.Error),\n   #\"Columnas con nombre cambiado\" = Table.RenameColumns(#\"Convertido en tabla\",{{\"Column1\", \"Fecha\"}}),\n    #\"Tipo cambiado\" = Table.TransformColumnTypes(#\"Columnas con nombre cambiado\",{{\"Fecha\", type date}}),\n    #\"Año insertado\" = Table.AddColumn(#\"Tipo cambiado\", \"Año\", each Date.Year([Fecha]), Int64.Type),\n    #\"Trimestre insertado\" = Table.AddColumn(#\"Año insertado\", \"Trimestre\", each Date.QuarterOfYear([Fecha]), Int64.Type),\n    #\"Mes insertado\" = Table.AddColumn(#\"Trimestre insertado\", \"Num. Mes\", each Date.Month([Fecha]), Int64.Type),\n    #\"Nombre del mes insertado\" = Table.AddColumn(#\"Mes insertado\", \"Mes\", each Date.MonthName([Fecha]), type text),\n    #\"Poner En Mayúsculas Cada Palabra\" = Table.TransformColumns(#\"Nombre del mes insertado\",{{\"Mes\", Text.Proper, type text}}),\n    #\"Día insertado\" = Table.AddColumn(#\"Poner En Mayúsculas Cada Palabra\", \"Día\", each Date.Day([Fecha]), Int64.Type)\nin\n    #\"Día insertado\";\r\nshared Productos_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"e234b20b-49a1-4e27-85b8-03fa86367e92\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"c793aaa5-107c-4822-b577-2776dbdb517e\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Productos\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[ProductID = nullable Int64.Type, Name = nullable Text.Type, Color = nullable Text.Type, ListPrice = nullable Number.Type, Subcategory = nullable Text.Type, Category = nullable Text.Type], {}), [DeleteWhenEmpty = false])\r\nin\r\n  Table;\r\nshared Territorios_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"e234b20b-49a1-4e27-85b8-03fa86367e92\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"c793aaa5-107c-4822-b577-2776dbdb517e\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Territorios\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[TerritoryID = nullable Int64.Type, Región = nullable Text.Type, Grupo = nullable Text.Type], {}), [DeleteWhenEmpty = false])\r\nin\r\n  Table;\r\nshared Órdenes_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"e234b20b-49a1-4e27-85b8-03fa86367e92\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"c793aaa5-107c-4822-b577-2776dbdb517e\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Ordenes\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[SalesOrderID = nullable Int64.Type, OrderQty = nullable Int64.Type, ProductID = nullable Int64.Type, UnitPrice = nullable Number.Type, UnitPriceDiscount = nullable Number.Type, OrderDate = nullable Date.Type, DueDate = nullable Date.Type, ShipDate = nullable Date.Type, TerritoryID = nullable Int64.Type], {}), [DeleteWhenEmpty = false])\r\nin\r\n  Table;\r\nshared Calendario_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"e234b20b-49a1-4e27-85b8-03fa86367e92\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"c793aaa5-107c-4822-b577-2776dbdb517e\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Calendario\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[Fecha = nullable Date.Type, Año = nullable Int64.Type, Trimestre = nullable Int64.Type, #\"Num. Mes\" = nullable Int64.Type, Mes = nullable Text.Type, Día = nullable Int64.Type], {}), [DeleteWhenEmpty = false])\r\nin\r\n  Table;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared Productos_WriteToDataDestination = let\r\n  Productos_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = Productos_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], Productos_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  Productos_WriteToDataDestination;\r\nshared Productos_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(Productos, {\"ProductID\", \"Name\", \"Color\", \"ListPrice\", \"Subcategory\", \"Category\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared Órdenes_WriteToDataDestination = let\r\n  Órdenes_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = Órdenes_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], Órdenes_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  Órdenes_WriteToDataDestination;\r\nshared Órdenes_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(Órdenes, {\"SalesOrderID\", \"OrderQty\", \"ProductID\", \"UnitPrice\", \"UnitPriceDiscount\", \"OrderDate\", \"DueDate\", \"ShipDate\", \"TerritoryID\"})\r\nin\r\n    SourceTable;\r\n[Staging = \"FastCopyStaging\"]\r\nshared Territorios_WriteToDataDestination = let\r\n  Territorios_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = Territorios_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], Territorios_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  Territorios_WriteToDataDestination;\r\nshared Territorios_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(Territorios, {\"TerritoryID\", \"Región\", \"Grupo\"})\r\nin\r\n    SourceTable;\r\n[Staging = \"FastCopyStaging\"]\r\nshared Calendario_WriteToDataDestination = let\r\n  Calendario_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = Calendario_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], Calendario_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  Calendario_WriteToDataDestination;\r\nshared Calendario_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(Calendario, {\"Fecha\", \"Año\", \"Trimestre\", \"Num. Mes\", \"Mes\", \"Día\"})\r\nin\r\n    SourceTable;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}],"trustedConnections":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]}}